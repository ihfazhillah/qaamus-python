!function(t){function e(e,n){var i,o,s,a=jQuery.extend({},{php:"",id:"",title:"",displaymode:!1,debug:!1,skin:"skins/skin.png",stars:5,step:1,round:!0,cursor:"pointer",load:!0,enable:!0,animate:!1,easing:5,showtext:!0,textlocation:"bottom",minvotes:0,textstart:"rate to see statistics",textloading:"...loading",textminvotes:"%r votes required",textmain:"%ms / %maxs (from %v votes)",texthover:"very bad|bad|average|good|perfect",textthanks:"thank you",textdelay:1500,ondata:function(){},onmove:function(){},onlieve:function(){},onclick:function(){}},n),r=new Array,l=-1,d=0,u=0,p=0,c="stars_"+Math.floor(1e4*Math.random())+"_"+(new Date).getTime()+"_"+Math.floor(1e4*Math.random()),f=-1,g=0,v=0,h=0,m=!1,x=!1,y=!0,b=!1,w=function(){V(),D(),P(),j(),_()},_=function(){if(a.displaymode)return a.enable=!1,y=!1,j(),void M(h+"|"+g+"|99999|",!1);if(1!=arguments[0]&&1!=a.load)return void z(a.textstart);if(""==a.php||""==a.id){if(""!=a.id){if(k()){if(arguments[0])g=Math.min(Math.max(v,0),100),localStorage.setItem(a.id,g),h=1;else{var e=localStorage.getItem(a.id);e?(g="string"==typeof e?G(e):e,h=1):(g=0,h=0)}return void M(h+"|"+g+"|"+(arguments[0]?a.textdelay/1e3:0)+"|",arguments[0]?!0:!1)}return m=!0,void P()}return m=!0,void P()}S();var n=!1,i="?";i=i.concat("id=",encodeURIComponent(a.id)),""!=a.title&&(i=i.concat("&i=",encodeURIComponent(a.title))),arguments[0]&&(i=i.concat("&r=",Math.min(Math.max(v,0),100)),n=!0),i=i.concat("&ref=",encodeURIComponent(document.URL)),i=i.concat("&rnd=",(new Date).getMilliseconds(),"_",Math.floor(1e3*Math.random()));t.ajax({type:"POST",url:a.php+i,dataType:"text",contentType:"charset=utf-8",data:"",done:function(t){M(t,n)},fail:function(t,e,n){z("PHP problem | "+a.php+" | "+n,a.debug),S()},success:function(t){M(t,n)},error:function(t,e,n){z("PHP problem | "+a.php+" | "+n,a.debug),S()}})},k=function(){try{return"object"==typeof window.localStorage}catch(t){return!1}},M=function(t,e){S();var n=t.split("|");if(""!=n[3]&&"undefined"!=typeof n[3])z("Error: "+n[3],a.debug),"function"==typeof a.ondata&&a.ondata({id:a.id,value:g,votes:h,error:n[3]});else{if(m=!0,h=parseInt(n[0]),g=parseFloat(n[1]),H(),r[1].target=h>=a.minvotes?E(g):0,a.animate||(r[1].value=r[1].target),e&&a.textdelay>0?setTimeout(D,a.textdelay):D(),P(),y){n[2]=parseInt(n[2]);var i=n[2]>500?5e5:Math.max(0,1e3*n[2]);e&&a.textdelay>0&&(i=Math.max(i,a.textdelay)),i>0?setTimeout(T,i):T()}"function"==typeof a.ondata&&a.ondata({id:a.id,value:g,votes:h,error:""})}},I=function(){x=!1,P()},T=function(){a.enable=!0,j()},S=function(){a.enable=!1,j()},P=function(){var t;x&&a.textdelay>0?(t=a.textthanks,setTimeout(I,a.textdelay)):t=m?a.minvotes>h?a.textminvotes:a.textmain:a.load?a.textloading:a.textstart,z(t)},z=function(t){a.showtext&&arguments[1]!==!1&&(t=$(t),b&&o.html(t))},$=function(t){return"string"!=typeof t?t:(t=t.replace(/%v/gi,h),t=t.replace(/%ms/gi,Math.round(10*X(g))/10),t=t.replace(/%ps/gi,Math.round(10*X(v))/10),t=t.replace(/%maxs/gi,a.stars),t=t.replace(/%m/gi,Math.round(E(g))),t=t.replace(/%p/gi,Math.round(E(v))),t=t.replace(/%rr/gi,a.minvotes-h),t=t.replace(/%r/gi,a.minvotes))},j=function(){t("#"+c).unbind("mouseover",U),t("#"+c).unbind("mousemove",C),t("#"+c).unbind("mousedown",F),t("#"+c).unbind("mouseup",L),t("#"+c).unbind("mouseleave",R),1==a.enable&&(t("#"+c).bind("mouseover",U),t("#"+c).bind("mousemove",C),t("#"+c).bind("mousedown",F),t("#"+c).bind("mouseup",L),t("#"+c).bind("mouseleave",R)),t("#"+c).css("cursor",a.enable?a.cursor:"auto")},C=function(e){var n=t("html").scrollLeft();n||(n=t("body").scrollLeft());var i=e.clientX-t("#"+c).offset().left+n;i>d?i=d:0>i&&(i=0),i=Q(i);var o=100*i/d;if(v=Math.round(10*o)/10,a.showtext){var r=s.length;if(r>=1){var l=Math.ceil(o*r/100)-1;l=0>l?0:l>r-1?r-1:l,z(s[l])}}N(1,0,!1,!0),N(2,i,!1),f!=o&&"function"==typeof a.onmove&&(f=o,a.onmove(o))},L=function(t){S(),F(t),x=!0,P(),f=-1,_(!0),"function"==typeof a.onclick&&a.onclick(v)},F=function(){r[1].target=a.minvotes>h?0:g,r[1].value=v,N(2,0,!1,!0),O(1,v,a.step>0&&a.round)},R=function(){P(),r[1].target=a.minvotes>h?0:E(g);var t;a.animate?(r[1].value=v,t=v):(r[1].value=r[1].target,t=g),f=-1,N(2,0,!1,!0),O(1,a.minvotes>h?0:t,a.step>0&&a.round),D(),"function"==typeof a.onlieve&&a.onlieve()},U=function(t){H(),N(1,0,!1,!0),C(t)},A=function(){for(var t,e=0,n=1;2>n;n++)t=r[n].target-r[n].value,0==t?e++:r[n].value+=Math.abs(t)<1?t:a.easing<=0?t:t/(1+a.easing),O(n,r[n].value,a.step>0&&a.round);1==e&&H()},D=function(){-1==l&&(O(1,r[1].value,a.step>0&&a.round),l=setInterval(A,20))},H=function(){clearInterval(l),l=-1},N=function(t,e,n,o){1==n&&(e=q(e)),e=Math.min(Math.round(e),d*a.stars),i[t].style.width=e+"px",t>0&&!o&&(i[0].style.backgroundPosition=-e+"px 0",i[0].style.left=e+"px",i[0].style.width=d-e+"px")},O=function(t,e,n){e=Math.round(d*e/100),N(t,e,n)},Q=function(t){return a.step>0?Math.ceil(t/(u*a.step))*u*a.step:t},q=function(t){return a.step>0?Math.round(t/(u*a.step))*u*a.step:t},E=function(t){return a.round?100*q(t*d/100)/d:t},X=function(t){return a.step>0&&a.round?Math.round(t*d/(100*u*a.step))*a.step:t*d/(100*u)},B=function(){if(""==a.id){var t=e.attr("id");void 0!=t&&(a.id=t)}for(var n in a)a.hasOwnProperty(n)&&"function"!=typeof a[n]&&(settings_string=e.data(n),"undefined"!=typeof settings_string&&("string"==typeof settings_string?(settings_string=settings_string.replace("/	\n\r/i",""),settings_string=settings_string.replace(/^\s+|\s+$/g,""),a[n]="id"==n||"title"==n?settings_string:G(settings_string)):a[n]=settings_string,J(n)));if(settings_string=e.data("value"),"undefined"!=typeof settings_string&&""!=settings_string&&(g=parseFloat(settings_string),g=0>g?0:g>100?100:g),settings_string=e.data("votes"),"undefined"!=typeof settings_string&&""!=settings_string&&(h=parseInt(settings_string),h=0>h?0:h),settings_string=e.data("settings"),"undefined"!=typeof settings_string&&""!=settings_string){settings_string=settings_string.replace("/	\n\r/i","");for(var i=settings_string.split(";"),o=0;o<i.length;o++){var s=i[o].split(":");s[0]=s[0].replace(/\s/g,""),"undefined"!=typeof a[s[0]]&&s.length>=2&&(s[1]=s[1].replace(/^\s+|\s+$/g,""),a[s[0]]=G(s[1]),J(s[0]))}}J("enable"),J("texthover")},G=function(t){var e=t.toLowerCase();return e==String("false")||e==String("no")?!1:e==String("true")||e==String("yes")?!0:0==isNaN(parseFloat(t))?parseFloat(t):t},J=function(t){switch(t){case"easing":a.easing<0&&(a.easing=0);break;case"step":a.step<0&&(a.step=0);break;case"stars":a.stars<0&&(a.stars=0);break;case"minvotes":a.minvotes<0&&(a.minvotes=0);break;case"textdelay":a.textdelay<0&&(a.textdelay=0);break;case"texthover":"string"==typeof a.texthover?s=a.texthover.split("|"):(s=[],s[0]=a.texthover.toString());break;case"enable":y=a.enable}},K=function(n){b=!1;var i=(t('<img "/>'),a.skin.split("|")[0]),s=new Image;s.onload=function(){u=this.width,p=this.height,0!=u&&0!=p||!a.debug?n?(V(!0),P(),D(),j()):w():(o=t('<div class="rating-text" style="z-index:3;">detected skin '+i+" size "+u+"x"+p+" please check the path to skin file.</div>"),e.empty(),e.append(o))},s.onerror=function(){a.debug&&(o=t('<div class="rating-text" style="z-index:3;">cannot load skin '+i+". Please check the path to skin file.</div>"),e.empty(),e.append(o))},s.src=i},V=function(n){var s=a.skin.split("|"),l=1==s.length?!0:!1,f=parseInt(p/(l?3:1));d=a.stars*u;var v=e.css("position");"static"==v&&e.css("position","relative"),s[0]=s[0].replace(/^\s+|\s+$/g,""),s[1]=s.length<2?s[0]:s[1].replace(/^\s+|\s+$/g,""),s[2]=s.length<3?s[1]:s[2].replace(/^\s+|\s+$/g,"");var m="position:absolute;top:0px;left:0px;padding:0;margin:0;background:",x='<div id="'+c+'" style="display:block;position:relative;overflow:hidden;width:'+d+"px;height:"+f+'px;top:0px;left:0px;">';if(x+='<div style="'+m+"url("+s[0]+") repeat-x;width:"+d+"px;height:"+f+'px;z-index:0;"></div>',x+='<div style="'+m+"url("+s[1]+") 0px "+(l?-f:0)+"px repeat-x;width:0px;height:"+f+'px;z-index:1;"></div>',x+='<div style="'+m+"url("+s[2]+") 0px "+(l?2*-f:0)+"px repeat-x;width:0px;height:"+f+'px;z-index:2;"></div>',x+="</div>",o=t('<div class="rating-text" style="z-index:3;"></div>'),"top"!=a.textlocation&&"bottom"!=a.textlocation){var y=t("#"+a.textlocation);1==y.length?o=y:a.textlocation="bottom"}e.empty(),"top"==a.textlocation?e.append(o,x):"bottom"==a.textlocation?e.append(x,o):e.append(x),i=t("#"+c).children("div");var w=a.minvotes<=h||g>0&&!b?g:0;r[1]=1==n?{value:w,target:w}:{value:a.animate?0:w,target:w},0==a.stars&&(e.css("height","0px"),d=1),"static"==v&&e.css("position","static"),b=!0},W=function(){H(),g=0,v=0,h=0,m=!1,x=!1,_()};this.option=function(n,i){if("undefined"!=typeof n){if(n=n.replace(/^\s+|\s+$/g,""),"undefined"==typeof a[n])return e;if("undefined"==typeof i)return a[n];if("string"==typeof i?(i=i.replace(/^\s+|\s+$/g,"").toLowerCase(),a[n]=G(i)):"boolean"==typeof i?a[n]=i:"number"==typeof i&&(a[n]=i),J(n),"enable"==n&&b)j();else if("cursor"==n&&b)t("#"+c).css("cursor",a.enable?a.cursor:"auto");else if("id"==n)W();else if("showtext"==n&&b)a.showtext?P():o.html("");else if("skin"==n)K(!0);else if(!b||"round"!=n&&"step"!=n)if("textlocation"==n&&b)if("top"==a.textlocation)o.prependTo(e);else if("bottom"==a.textlocation)o.appendTo(e);else{var s=t("#"+a.textlocation);1==s.length&&o.appendTo(s)}else if("stars"==n&&b){d=a.stars*u,t("#"+c)[0].style.width=d+"px",P();var l=r[1].value;r[1].value=0,D(),r[1].value=l}else"load"==n&&b?(m=!1,P()):1==a.showtext&&b&&"text"==n.substr(0,4)&&P();else r[1].target=h>=a.minvotes?E(g):0,a.animate||(r[1].value=r[1].target),P(),D();return e}},this.value=function(t){return"undefined"==typeof t?g:(t=0>t?0:t>100?100:t,r[1]={target:t,value:g},g=t,P(),1==arguments[1]&&(r[1].value=t),b&&D(),e)},this.votes=function(t){return"undefined"==typeof t?h:(t=0>t?0:t,h=t,P(),e)},this.id=function(t){return"undefined"==typeof t?a.id:(a.id=t,W(),e)},B(),K(!1)}var n="rating";t.fn[n]=function(i){if(0==this.length)return!1;var o=arguments[0];if("string"==typeof o){var s=Array.prototype.slice.call(arguments,1);if("string"==typeof o){var a=t(this),r=a.data(n);if("function"==typeof r[i])return r[i].apply(a[0],s)}}else if("object"==typeof i||!i)return this.each(function(){{var o=t(this);o.data(n)}return"object"!=typeof i&&i?void 0:o.data(n,new e(o,i))})}}(jQuery);